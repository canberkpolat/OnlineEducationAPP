@model List<Message>
@using Microsoft.AspNetCore.Identity
@using OnlineEducationAPP.MvcWebUI.Identity;

@inject UserManager<ApplicationUser> UserManager
@{
    Layout = null;
}
<!DOCTYPE html>
<html class="loading" lang="en" data-textdirection="ltr">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta name="description" content="Modern admin is super flexible, powerful, clean &amp; modern responsive bootstrap 4 admin template with unlimited possibilities with bitcoin dashboard.">
    <meta name="keywords" content="admin template, modern admin template, dashboard template, flat admin template, responsive admin template, web app, crypto dashboard, bitcoin dashboard">
    <meta name="author" content="PIXINVENT">
    <title>
        Private Chat
    </title>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Quicksand:300,400,500,700"
          rel="stylesheet">
    <link href="https://maxcdn.icons8.com/fonts/line-awesome/1.1/css/line-awesome.min.css"
          rel="stylesheet">

    <partial name="_CssJsLinks" />
    <partial name="_Header" />
    <partial name="_Navbar" />
</head>
<body class="horizontal-layout horizontal-menu horizontal-menu-padding content-left-sidebar chat-application  menu-expanded"
      data-open="click" data-menu="horizontal-menu" data-col="content-left-sidebar">
    <div class="app-content container center-layout mt-2">
        <div class="content-right">
            <div class="content-wrapper">
                <div class="content-header row">
                </div>

                <div class="content-body">
                    <section class="chat-app-window">
                        @if (Model == null)
                        {

                        }<div class="chats" id="chats">
                            @foreach (var message in Model)
                            {
                                @if (message.SenderUser.UserName == User.Identity.Name)
                                {
                                    <div class="chat">
                                        <div class="chat-avatar">
                                            <a class="avatar" data-toggle="tooltip" href="#" data-placement="right" title=""
                                               data-original-title="">
                                                @await GravatarHtmlHelper.GravatarImage(UserManager, message.SenderUser.Email, size: 48, defaultImage: GravatarHtmlHelper.DefaultImage.Identicon, rating: GravatarHtmlHelper.Rating.PG, cssClass: "")
                                            </a>
                                        </div>
                                        <div class="chat-body">
                                            <div class="chat-content">
                                                <p>@message.Messages</p>
                                            </div>
                                        </div>
                                    </div>
                                }
                                else
                                {

                                    <div class="chat chat-left">
                                        <div class="chat-avatar">
                                            <a class="avatar" data-toggle="tooltip" href="#" data-placement="left" title=""
                                               data-original-title="">
                                                @await GravatarHtmlHelper.GravatarImage(UserManager, message.SenderUser.Email, size: 48, defaultImage: GravatarHtmlHelper.DefaultImage.Identicon, rating: GravatarHtmlHelper.Rating.PG, cssClass: "")
                                            </a>
                                        </div>
                                        <div class="chat-body">
                                            <div class="chat-content">
                                                <p>@message.Messages</p>
                                            </div>
                                        </div>
                                    </div>

                                }
                            }
                        </div>
                    </section>
                    <section class="chat-app-form">
                        <div class="inline-form">
                            <input id="room-name" type="hidden" name="roomName" value="@ViewBag.RoomId" />
                            <input id="messageInput" type="text" class="form-control pl-1 mw-100" style="width: 100%;" placeholder="Type your message">
                            <a id="sendButtonPrivate" class="btn btn-info ml-1">
                                <span class="d-none d-lg-block">Send</span>
                            </a>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </div>
</body>
</html>

<script>
    var userId = "@ViewBag.UserId";
    var receiverId = "@ViewBag.ReceiverUserId";
</script>
<script src="~/lib/signalr/dist/browser/signalr.js"></script>
<script src="~/js/chat.js"></script>